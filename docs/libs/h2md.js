(function(){/*
 Copyright 2014-2015 AXELL Corporation.
 H2MD JavaScript Library
 version 1.0.2.2
*/
for(var e,requestAnimationFrame,l=!1,q=["ms","moz","webkit","o"],t=0;t<q.length&&l;++t)l=window[q[t]+"RequestAnimationFrame"];requestAnimationFrame=l;
function z(){this.C=-1;this.a={};this.a.width=0;this.a.height=0;this.a.L=0;this.a.K=0;this.a.frames=0;this.a.Sa=0;this.a.Na=0;this.a.J=0;this.a.$=1;this.a.R=1;this.N=this.g=this.a.w=0;this.ca=[];this.ba=[];this.v=this.B=this.s=this.f=null;this.c=new aa;this.o=new ba;this.A=0;this.C=-1;this.G=this.m=null;this.Ma={};this.La={};this.Aa={};this.b={};this.b.na=null;this.b.la=null;this.b.buffered=null;this.b.done=null;this.b.request=null;this.b.T=null;this.b.S=null;this.b.ma=null;this.ia=!1;this.ha="";
this.sa=this.ra=!1;this.da=this.ea=this.ga=this.fa=0;this.pa=null;this.l=this.ta=this.u=0;this.F=-1;this.i=0;this.W=[];this.U=this.V=this.X=this.D=0;this.H=!1}var C=[];function ca(a,b){var c=a.split("/"),c=c[c.length-1];C[c]=b;c=document.createElement("script");c.type="text/javascript";c.src=a;document.body.appendChild(c)}
function D(a){0!=a.l&&a.X-a.V>=a.l*a.a.J?(a.u=5,setTimeout(a.I.bind(a),500)):a.g>=a.a.R&&a.N>=a.a.$?(a.u=6,0==a.l&&(a.D=a.s.frame),a.I()):a.g<a.ta&&a.g<a.a.R?0==a.l?(a.u=4,M(a,a.g,!1)):(a.u=4,a.I()):(a.u=3,0==a.l&&(a.D=a.s.frame),a.X=a.s.frame,da(a))}function ea(a){a.B&&!a.v&&(a.v=a.B.getContext("2d"))}e=z.prototype;
e.I=function(){switch(this.u){case 0:this.u=1;da(this);break;case 1:this.u=2;var a;a={j:0};if(72!=N(this.c,a)||50!=N(this.c,a)||77!=N(this.c,a))a="invalid file";else{var b=O(this.c,a);if(2!=b&&3!=b&&4!=b)a="invalid version";else{this.a.version=b;this.a.O=O(this.c,a);this.a.w=O(this.c,a);this.a.frames=O(this.c,a);var c=O(this.c,a),d=O(this.c,a);this.a.J=1*c/d;this.a.width=O(this.c,a);this.a.height=O(this.c,a);this.a.$=O(this.c,a);this.a.R=O(this.c,a);this.a.Sa=O(this.c,a);this.a.Na=O(this.c,a);4>b?
(this.a.P=O(this.c,a),this.a.Pa=this.a.P,this.a.Y=32):(a=O(this.c,a),this.a.P=1<<(a&255),this.a.Pa=1<<(a>>8&255),this.a.Y=1<<(a>>16&255));this.a.L=fa(this.a.width,this.a.Y);this.a.K=fa(this.a.height,this.a.Y);this.sa||(this.ga=this.fa=0,this.ea=this.a.width,this.da=this.a.height);a=this.c;b=a.a;c=this.a.$*a.c;window.ArrayBuffer?a.a=new Uint8Array(c):a.a=Array(c);for(c=0;c<b.length;c++)a.a[c]=b[c];a=null}}if(a){P(this,a);break}this.f=ga(this);this.s=ga(this);this.X=this.D=0;a=this.o;b=this.c;c=this.l;
a.a=this.a;a.c=b;a.B=c;this.N++;M(this,this.g,!1);break;case 2:this.W[this.g]=0;this.g++;this.b.na&&this.b.na();ha(this);D(this);0!=this.l&&(this.i=1,this.ja());break;case 4:this.W[this.g]=this.X+1;this.g++;D(this);break;case 3:this.N++;ha(this);D(this);break;case 5:D(this);break;case 6:this.b.buffered&&this.b.buffered()}};function ia(a){a.D=a.W[a.i];a.i==a.a.R-1&&(a.D=a.a.frames);a.i++;a.ja()}
e.ja=function(){if(-1!=this.F){if(this.i>this.F||this.i+2<this.F)this.i=this.F;this.F=-1}var a=this.i>=this.g;a||(a=this.W[this.i]-this.V>=this.l*this.a.J);a?setTimeout(this.ja.bind(this),500):M(this,this.i,!0)};function P(a,b){a.b.la&&a.b.la("H2MD : "+b)}
function da(a){if(!(a.N>=a.a.$)){var b=a.G+".s"+("00000000"+a.N).slice(-8),c=b+".b64",d=function(b){var c=a.c;b=window.atob(b);var d=b.length;null==c.a&&(c.a=Array(d),c.c=d);var k=c.b;if(c.a.length<k+d)throw"invalid syntax data size";for(var g=0;g<d;g++)c.a[k+g]=b.charCodeAt(g);c.b+=d;a.I()};if(a.b.request)a.b.request(c,d);else if(a.ra)ca(b+".js",d);else{var h;window.XMLHttpRequest?h=new XMLHttpRequest:window.ActiveXObject?h=new ActiveXObject("Microsoft.XMLHTTP"):h=null;h.open("GET",c,!0);h.onreadystatechange=
function(){4==h.readyState&&(200==h.status?d(h.responseText):P(a,"syntax not found"))};h.onerror=function(){P(a,"syntax not found")};h.send(null)}}}function ja(a,b,c){return a.b.request?b:b+c}function ka(a,b,c,d,h){b[c]=new Image;b[c].onload=h;b[c].onerror=function(){P(a,"i picture image not found")};b[c].src=d}
function M(a,b,c){if(!(b>=a.a.R)){var d=ja(a,a.G+".i"+("00000000"+b).slice(-8)+".jpg",a.ha),h=ja(a,a.G+".a"+("00000000"+b).slice(-8)+".png",a.ha),n=function(d){ka(a,a.ba,b,d,function(){a.o.o[b]=a.ba[b];a.ba[b]=null;c?ia(a):a.I()})},u=function(d){ka(a,a.ca,b,d,function(){var d=a.o;d.b[b]=a.ca[b];if(0==b&&!d.g){var g=d.a.P;d.l=d.b[b].width/g;d.u=d.b[b].height/g;d.g=document.createElement("canvas");d.g.width=d.b[b].width;d.g.height=d.b[b].height;d.s=d.g.getContext("2d");d.s.clearRect(0,0,d.g.width,d.g.height)}a.ca[b]=
null;a.a.w&16?a.b.request?a.b.request(h,n):n(h):c?ia(a):a.I()})};a.b.request?a.b.request(d,u):u(d)}}e.Da=function(a){this.b.la=a};e.done=function(a){this.b.done=a};e.buffered=function(a){this.b.buffered=a};e.request=function(a){this.b.request=a};e.T=function(a){this.b.T=a};e.S=function(a){this.b.S=a};e.Ua=function(a){this.b.ma=a};e.open=function(a,b){this.G?P(this,"new instance require"):(this.G=a,this.b.na=b,this.I())};e.Ba=function(a){return(a=document.getElementById(a))?this.ua(a):!1};
e.ua=function(a){if(!(a instanceof HTMLCanvasElement))return!1;this.B=a;this.v=null;this.qa&&ea(this);return!0};e.Ka=function(a,b,c,d){this.sa=!0;this.fa=a;this.ga=b;this.ea=c;this.da=d};e.Fa=function(a){if(void 0===a||-1>a)return!1;this.C=a;return!0};e.Ga=function(){return ma(this)};function ma(a){if(a.m||-1>a.C||a.C>=a.a.frames||!a.B)return!1;requestAnimationFrame?(a.m=!0,a.U=(new Date).getTime(),requestAnimationFrame(function(){oa(a)})):a.m=setInterval(function(){pa(a)},1E3/a.a.J);return!0}
function oa(a){if(a.m){for(var b=(new Date).getTime(),c=1E3/a.a.J,d=Math.ceil(a.a.J/60);b-a.U>=c;)1<=d&&pa(a),a.U+=c,d--;requestAnimationFrame(function(){oa(a)})}}e.ya=function(){return null!=this.m};e.Ja=function(a){if(void 0===a||0>a||a>=this.a.frames)return!1;this.A=a;return!0};e.aa=function(){this.oa();this.A=0};e.oa=function(){this.m&&("number"===typeof this.m&&clearInterval(this.m),this.m=null)};e.Ia=function(a){this.ia=a};
e.Ea=function(){if(0==this.a.frames)return null;var a={};a.width=this.a.width;a.height=this.a.height;a.fps=this.a.J;a.frames=this.a.frames;a.version=this.a.version;return a};e.Ha=function(){if(0==this.a.frames)return null;var a={};a.frames=this.a.frames;a.current_frame=this.V;a.buffered_frame=this.D;return a};e.Oa=function(a){this.pa=a};e.Ca=function(a){return this.ka(a,0,0,this.a.width,this.a.height,0,0,this.a.width,this.a.height)};
e.ka=function(a,b,c,d,h,n,u,v,k){if(void 0===a||0>a||a>=this.a.frames)return null;try{this.V=a;var g=a-(this.f.frame-1);if(!(0<=g&&g<=this.f.M)&&1!=g){var m=0,f=this.Aa;f.h=0;for(f.j=this.a.O;;){var w=f.j,y=Y(this,f);if(a<m+y.frames){this.f.frame=m;this.f.M=0;this.f.j=w;this.f.h=f.h;break}f.j=w+y.za;f.h=f.h+y.Z;m+=y.frames}g=a-(this.f.frame-1)}for(m=0;m<g;m++){var la=this.f.frame%2,Aa=(this.f.frame+1)%2,x=sa(this.f),B=this.f.M;0==B&&(B=Y(this,x).frames);if(!this.qa){var r=this.o,na=this.B;r.f=Array(3);
r.i=Array(3);r.m=0;var Q=window.H2MD_WebGL||ua;"undefined"!=typeof Q&&Q.initialize(r.a.L,r.a.K,na)&&(r.m=1);for(f=0;3>f;f++)if(r.a.w&16||2!=f)if(r.m)r.f[f]={},r.f[f].id=f,r.i[f]=0==f?new Q(r.a.L,r.a.K,na):r.i[0];else{var E=r.a.L,F=r.a.K;262144>E*F&&(512>E&&(E=512),512>F&&(F=512));r.f[f]=document.createElement("canvas");r.f[f].width=E;r.f[f].height=F;r.i[f]=r.f[f].getContext("2d")}var R=navigator.userAgent;r.F=-1!=R.search(/iPhone/)||-1!=R.search(/iPad/)||-1!=R.search(/iPod/);ea(this);this.qa=!0}var p=
this.o,Ba=x.j,S=va(p,x);p.A=p.F||p.m?!0:1==S.xa;var A=p.i[la],qa=p.i[2];p.m&&A.setFrameBuffer(la);if(p.a.w&16||p.m)A.clearRect(0,0,p.a.L,p.a.K),p.A||qa.clearRect(0,0,p.a.L,p.a.K);var w=f=0,T=p.a.Y;p.D=3<=p.a.version&&p.a.w&16;for(y=0;y<p.a.K;y+=T)for(var G=0;G<p.a.L;G+=T){0==f?(w=N(p.c,x),f=w%8,w>>=3):f--;if(0>w||32<=w)throw"cu_type broken "+w;Z(p,0,w,G,y,x,A,qa,T,Aa,S.xa)}p.a.w&16&&!p.A&&(A.globalCompositeOperation="destination-in",A.drawImage(p.f[2],0,0),A.globalCompositeOperation="source-over");
var U=x.j-Ba,ra=S.wa;if(4<=U-ra)throw"frame data overflow";for(;U<ra;)x.j++,U++;var f=p,V=Math.floor(x.h/p.l/p.u);if(V-1>f.v&&0!=f.B){for(var H=f.v;H<V;H++)f.b[H]=null,f.o[H]=null;f.v=V-1}B--;0==B&&wa(this,x);var I=this.f;I.M=B;I.j=x.j;I.h=x.h;I.frame++}this.ya()&&this.a.w&16&&this.v&&this.v.clearRect(0,0,this.B.width,this.B.height);var ta;var J=this.o;a=a%2;var W=this.pa,K=this.v,L;J.m?(J.i[a].setFrameBuffer(a),L=J.i[a].composite(b,c,d,h,n,u,v,k,W)):L=J.f[a];null!=K&&(W&&(K.globalCompositeOperation=
W),K.drawImage(L,b,c,d,h,n,u,v,k),K.globalCompositeOperation="source-over");ta=L;return ta}catch(X){if("reload"==X)return this.F=this.o.G,null;if("loading"==X)return null;this.aa();P(this,X)}};e.Ra=function(a){this.ha=a?"?"+(new Date).getTime():""};e.Qa=function(a){this.ra=a};e.Ta=function(a){this.l=a?60:0};function fa(a,b){return Math.floor((a+b-1)/b)*b}function ga(a){var b={frame:0,h:0,M:0};b.j=a.a.O;return b}
function pa(a){if(a.ia){var b=[];b.push((new Date).getTime())}a.ka(a.A,0,0,a.a.width,a.a.height,a.fa,a.ga,a.ea,a.da)?(a.H&&(a.H=!1,a.b.ma&&a.b.ma()),a.H=!1,a.A++,a.A>=a.a.frames&&(-1!=a.C?a.A=a.C:(a.A=0,a.aa(),a.b.done&&a.b.done())),a.ia&&(b.push((new Date).getTime()),b=""+(""+(b[1]-b[0])+"[msec]"),a.v.fillStyle="white",a.v.fillText(b,2,10)),a.b.T&&a.b.T()):a.H||(a.H=!0,a.b.S&&a.b.S())}
function Y(a,b){var c=N(a.c,b),d=N(a.c,b);N(a.c,b);if(71!=c||72!=d)throw"gop header broken";c=a.La;c.frames=O(a.c,b);c.za=O(a.c,b);c.Z=O(a.c,b);return c}function wa(a,b){var c=N(a.c,b),d=N(a.c,b);N(a.c,b);if(71!=c||84!=d)throw"gop tailer broken";c=a.Ma;c.frames=O(a.c,b);c.za=O(a.c,b);c.Z=O(a.c,b)}function sa(a){var b={};b.j=a.j;b.h=a.h;return b}
function ha(a){for(;a.s.frame<a.a.frames;)try{var b=sa(a.s),c=a.s.M;0==c&&(c=Y(a,b).frames);var d=b,h=va(a.o,d);d.h+=h.Z;d.j+=h.wa-h.O;c--;0==c&&wa(a,b);var n=a.s,d=b;n.M=c;n.j=d.j;n.h=d.h;n.frame++}catch(u){break}b=a.o;a.ta=Math.floor((a.s.h+b.l*b.u-1)/b.l/b.u)}function aa(){this.a=null;this.c=this.b=0}function N(a,b){if(b.j>=a.b)throw"loading";var c=a.a[b.j];b.j++;return c}function O(a,b){var c=N(a,b),c=c<<8|N(a,b);return c=c<<8|N(a,b)}
function ba(){this.C=this.s=this.g=this.i=this.f=null;this.A=!0;this.D=this.F=!1;this.c=this.a=null;this.b=[];this.o=[];this.u=this.l=0;this.v=-1;this.G=this.B=0;this.H={}}var ua;function xa(a,b){var c=!0;a.b[b]&&a.b[b].complete||(c=!1);a.a.w&16&&(a.o[b]&&a.o[b].complete||(c=!1));if(!c){if(0!=a.B)throw a.G=b,b<a.v&&(a.v=b-1),"reload";throw"loading";}}
function va(a,b){var c=N(a.c,b);if(70!=c)throw"frame header broken "+c;c=a.H;c.xa=N(a.c,b);c.Va=N(a.c,b);c.O=O(a.c,b);c.wa=O(a.c,b);c.Z=O(a.c,b);for(var d=12;d<c.O;d+=3)O(a.c,b);return c}
function ya(a,b,c,d,h,n,u){var v=n.h%a.l,k=n.h/a.l|0,g=a.a.P,m=Math.floor(k/a.u),k=k%a.u*g,f=g*u;if(a.A){if(a.C!=m){xa(a,m);a.C=-1;if(!a.m||a.a.w&16)a.s.drawImage(a.b[m],0,0),a.a.w&16&&(a.s.globalCompositeOperation="destination-in",a.s.drawImage(a.o[m],0,0),a.s.globalCompositeOperation="source-over");a.m&&(a.g.id=2,a.a.w&16?b.setTexture(a.g):b.setTexture(a.b[m]));a.C=m}b.drawImage(a.g,v*g,k,f,g,d,h,f,g)}else xa(a,m),b.drawImage(a.b[m],v*g,k,f,g,d,h,f,g),a.a.w&16&&c.drawImage(a.o[m],v*g,k,f,g,d,h,
f,g);n.h+=u}function za(a,b,c){b=b-3;3<=Math.abs(b)&&(a=N(a.c,c),0>b?b-=a:b+=a);return b}
function Z(a,b,c,d,h,n,u,v,k,g,m){if(c&1)k>>=1,c>>=1<<2*b,Z(a,b+1,c,d,h,n,u,v,k,g,m),Z(a,b+1,c>>1,d+1*k,h,n,u,v,k,g,m),Z(a,b+1,c>>2,d,h+1*k,n,u,v,k,g,m),Z(a,b+1,c>>3,d+1*k,h+1*k,n,u,v,k,g,m);else{c=1;b=0;if(1==m||a.D)b=N(a.c,n),c=b>>6;switch(c){case 1:g=a.a.P;for(m=0;m<k;m+=g)if(n.h%a.l*g+k<=a.l*g)ya(a,u,v,d,h+m,n,k/g);else for(b=0;b<k;b+=g)ya(a,u,v,d+b,h+m,n,1);break;case 0:v=za(a,b>>3&7,n);n=za(a,b&7,n);u.drawImage(a.f[g],d+v,h+n,k,k,d,h,k,k);break;case 2:if(!a.D)throw"unsupport fill type version";
break;default:throw"cu_type broken "+c;}}}"object"===typeof module&&module.va&&(module.va=z,module.va.Wa=function(a){ua=a});window.H2MD=z;z.prototype.open=z.prototype.open;z.prototype.play=z.prototype.Ga;z.prototype.seek=z.prototype.Ja;z.prototype.playing=z.prototype.ya;z.prototype.stop=z.prototype.aa;z.prototype.pause=z.prototype.oa;z.prototype.error=z.prototype.Da;z.prototype.done=z.prototype.done;z.prototype.buffered=z.prototype.buffered;z.prototype.info=z.prototype.Ea;z.prototype.position=z.prototype.Ha;
z.prototype.decode=z.prototype.Ca;z.prototype.canvas=z.prototype.Ba;z.prototype.canvasElement=z.prototype.ua;z.prototype.stretch=z.prototype.Ka;z.prototype.loop=z.prototype.Fa;z.prototype.nonce_url=z.prototype.Ra;z.prototype.jsonp=z.prototype.Qa;z.prototype.streaming=z.prototype.Ta;z.prototype.timeupdate=z.prototype.T;z.prototype.suspended=z.prototype.S;z.prototype.willResume=z.prototype.Ua;z.prototype.request=z.prototype.request;z.prototype.composite=z.prototype.ka;
z.prototype.composite_operation=z.prototype.Oa;z.prototype.profile=z.prototype.Ia;z.jsonpRequest=ca;z.jsonpCallback=function(a){for(key in a)C[key](a[key])};})();
